
```python
import requests
from bs4 import BeautifulSoup
from datetime import datetime
import sys
import pandas as pd
```

```python
code='136990'
test_url = "https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code="+code+"&type=before&page=1"
resp = requests.get(test_url)
resp.content
html = BeautifulSoup(resp.content, 'html.parser')
# html
```

```python
score_result = html.find('div', {'class': 'score_result'})
lis = score_result.findAll('li')
lis[0]
```

```python
review_text = lis[0].find('p').getText()
type(review_text)
```

```python
score = lis[0].find('em').getText()
# score
```

```python
like = lis[0].find('div', {'class': 'btn_area'}).findAll('span')[1].getText()
dislike = lis[0].find('div', {'class': 'btn_area'}).findAll('span')[3].getText()
# like, dislike
```

```python
nickname = lis[0].findAll('a')[0].find('span').getText()
nickname
```

```python

created_at = datetime.strptime(lis[0].find('dt').findAll('em')[-1].getText(), "%Y.%m.%d %H:%M")
# created_at
```

```python
import requests
from bs4 import BeautifulSoup
from datetime import datetime
import sys
import pandas as pd
```

```python
def get_data(url):
    resp = requests.get(url)
    html = BeautifulSoup(resp.content, 'html.parser')
    score_result = html.find('div', {'class': 'score_result'})
    lis = score_result.findAll('li')
#     txt_list=[]
#     time_list=[]
#     score_list=[]
#     movie_list=[]
    for li in lis:
#         list1=[]
        nickname = li.findAll('a')[0].find('span').getText()
        created_at = datetime.strptime(li.find('dt').findAll('em')[-1].getText(), "%Y.%m.%d %H:%M")
        
        review_text = li.find('p').getText()
        score = li.find('em').getText()
        btn_likes = li.find('div', {'class': 'btn_area'}).findAll('span')
        like = btn_likes[1].getText()
        dislike = btn_likes[3].getText()        
        watch_movie = li.find('span', {'class':'ico_viewer'})
        
#         txt_list.append(review_text)
#         time_list.append(created_at)
#         score_list.append(score)
#         # 간단하게 프린트만 했습니다.
#         movie_list.append(list(zip(txt_list,time_list,score_list)))
#         print(movie_list)
#     data = {txt_list,time_list,score_list}
#         df = pd.DataFrame(movie_list)
#         df.to_csv(code+'.csv','a')
        print(created_at, review_text, score, like, dislike, watch_movie and True or False, nickname)
```

```python
# result = html.find('div', {'class':'score_total'}).find('strong').findChildren('em')[1].getText()
# int(result.replace(',', ''))
```

```python
test_url = 'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code=119412&type=after'
resp = requests.get(test_url)
html = BeautifulSoup(resp.content, 'html.parser')
result = html.find('div', {'class':'score_total'}).find('strong').findChildren('em')[1].getText()
total_count = int(result.replace(',', ''))

for i in range(1, int(total_count / 10) + 2):
    url = test_url + '&page=' + str(i)
#     print('url: "' + url + '" is parsing....')
    get_data(url)
```

```python
sys.stdout
```

```python
import requests
from bs4 import BeautifulSoup
from datetime import datetime
import sys
import pandas as pd
from tqdm import tqdm_notebook
```

```python
code='136990'
test_url = "https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code="+code+"&type=before&page=1"
resp = requests.get(test_url)
html = BeautifulSoup(resp.content, 'html.parser')
result = html.find('div', {'class':'score_total'}).find('strong').findChildren('em')[1].getText()
total_count = int(result.replace(',', ''))
# html
```

```python
score_result = html.find('div', {'class': 'score_result'})
lis = score_result.findAll('li')
# lis[0]
```

```python
review_text = lis[0].find('p').getText()
type(review_text)
```

```python
# created_at = datetime.strptime(lis[0].find('dt').findAll('em')[-1].getText()[0:10], "%Y.%m.%d")
created_at = lis[0].find('dt').findAll('em')[-1].getText()[0:10]
created_at = created_at.replace(".","")
created_at
```

```python

```

```python
import requests
from bs4 import BeautifulSoup
from datetime import datetime
import sys
import pandas as pd
from tqdm import tqdm_notebook
import multiprocessing

af='after'
be='before'
lis = pd.read_csv('/home/ubuntu/movie/data/naver_movie_all.csv')
movie_lis =[]

for i in range(len(lis['naver_movieCd'])):
    movie_lis.insert(i,str(lis['naver_movieCd'][i])[:-2])
# len(movie_lis)

def func11(code):
    lists = []
#     code=str(movie_lis[i])[:-2]
    test_url = 'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code='+code+'&type='+be+'&onlyActualPointYn=N&order=newest'
    resp = requests.get(test_url)
    html = BeautifulSoup(resp.content, 'html.parser')
    result = html.find('div', {'class':'score_total'}).find('strong').findChildren('em')[1].getText()
    total_count = int(result.replace(',', ''))
    print(code)
    for i in tqdm_notebook(range(1,int(total_count / 10) + 2)):
        url = test_url + '&page=' + str(i)
    #     print('url: "' + url + '" is parsing....')
    #     get_data(url)
        resp = requests.get(url)
        html = BeautifulSoup(resp.content, 'html.parser')
        score_result = html.find('div', {'class': 'score_result'})
    #     print(score_result)
        lis = score_result.findAll('li')
    #     print(lis[0])
        for li in lis:
            a = []
            created_at = li.find('dt').findAll('em')[-1].getText()[0:10]
            created_at = created_at.replace(".","")
            score = li.find('em').getText()
            review_text = li.find('p').getText()
            a = [created_at, score, review_text]
            lists.append(a)
    
    df = pd.DataFrame(lists)
#     df.to_csv('../data2/'+af+'2/'+code+'.csv',index=False)
    df.to_csv('/home/ubuntu/movie/data/'+be+'/'+code+'.csv',index=False)
    
pool = multiprocessing.Pool(processes=4)
pool.map(func11,movie_lis)
pool.close()
pool.join()
```

    153651
    118955
    166807
    165030



    HBox(children=(IntProgress(value=0, max=50), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=57), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=19), HTML(value='')))


    
    164335



    HBox(children=(IntProgress(value=0, max=9), HTML(value='')))


    
    162932



    HBox(children=(IntProgress(value=0, max=27), HTML(value='')))


    
    171753



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    150687



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    170427



    HBox(children=(IntProgress(value=0, max=109), HTML(value='')))


    
    154594



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    154598



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    
    158180



    HBox(children=(IntProgress(value=0, max=33), HTML(value='')))


    158626



    HBox(children=(IntProgress(value=0, max=11), HTML(value='')))


    
    159037



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    171767



    HBox(children=(IntProgress(value=0, max=1), HTML(value='')))


    
    141206



    HBox(children=(IntProgress(value=0, max=29), HTML(value='')))


    
    100205



    HBox(children=(IntProgress(value=0, max=23), HTML(value='')))


    
    158647



    HBox(children=(IntProgress(value=0, max=10), HTML(value='')))


    
    134963



    HBox(children=(IntProgress(value=0, max=11), HTML(value='')))


    
    
    159862



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    151728



    HBox(children=(IntProgress(value=0, max=51), HTML(value='')))


    
    125418



    HBox(children=(IntProgress(value=0, max=9), HTML(value='')))


    
    151744
    



    HBox(children=(IntProgress(value=0, max=3), HTML(value='')))


    19031



    HBox(children=(IntProgress(value=0, max=3), HTML(value='')))


    
    159848
    



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    36843



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    172005
    



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    168478



    HBox(children=(IntProgress(value=0, max=2), HTML(value='')))


    
    144975



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    144381
    



    HBox(children=(IntProgress(value=0, max=13), HTML(value='')))


    161242



    HBox(children=(IntProgress(value=0, max=121), HTML(value='')))


    
    155665



    HBox(children=(IntProgress(value=0, max=86), HTML(value='')))


    
    85579
    



    HBox(children=(IntProgress(value=0, max=417), HTML(value='')))


    152249



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    
    149504



    HBox(children=(IntProgress(value=0, max=27), HTML(value='')))


    
    169561



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    160749



    HBox(children=(IntProgress(value=0, max=83), HTML(value='')))


    
    165722



    HBox(children=(IntProgress(value=0, max=32), HTML(value='')))


    
    159830



    HBox(children=(IntProgress(value=0, max=32), HTML(value='')))


    
    163844



    HBox(children=(IntProgress(value=0, max=43), HTML(value='')))


    
    129095



    HBox(children=(IntProgress(value=0, max=13), HTML(value='')))


    
    153642
    



    HBox(children=(IntProgress(value=0, max=32), HTML(value='')))


    
    151196
    154353



    HBox(children=(IntProgress(value=0, max=50), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=22), HTML(value='')))


    
    169349



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    168501



    HBox(children=(IntProgress(value=0, max=9), HTML(value='')))


    
    152268



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    
    125488



    HBox(children=(IntProgress(value=0, max=28), HTML(value='')))


    
    
    164968
    65998



    HBox(children=(IntProgress(value=0, max=9), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=12), HTML(value='')))


    
    165669



    HBox(children=(IntProgress(value=0, max=41), HTML(value='')))


    
    150637



    HBox(children=(IntProgress(value=0, max=72), HTML(value='')))


    
    152656



    HBox(children=(IntProgress(value=0, max=19), HTML(value='')))


    
    160491



    HBox(children=(IntProgress(value=0, max=16), HTML(value='')))


    
    164108



    HBox(children=(IntProgress(value=0, max=7), HTML(value='')))


    
    150198



    HBox(children=(IntProgress(value=0, max=238), HTML(value='')))


    
    143250



    HBox(children=(IntProgress(value=0, max=22), HTML(value='')))


    
    121052



    HBox(children=(IntProgress(value=0, max=25), HTML(value='')))


    
    157178



    HBox(children=(IntProgress(value=0, max=25), HTML(value='')))


    
    142317
    



    HBox(children=(IntProgress(value=0, max=20), HTML(value='')))


    161850



    HBox(children=(IntProgress(value=0, max=46), HTML(value='')))


    
    163386



    HBox(children=(IntProgress(value=0, max=43), HTML(value='')))


    
    156200



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    
    99093



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    125439



    HBox(children=(IntProgress(value=0, max=10), HTML(value='')))


    
    158576



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    
    137890



    HBox(children=(IntProgress(value=0), HTML(value='')))


    
    155715



    HBox(children=(IntProgress(value=0, max=33), HTML(value='')))


    
    169262



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    149248



    HBox(children=(IntProgress(value=0, max=48), HTML(value='')))


    
    164986



    HBox(children=(IntProgress(value=0, max=27), HTML(value='')))


    
    142210



    HBox(children=(IntProgress(value=0, max=13), HTML(value='')))


    
    169348



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    168037
    



    HBox(children=(IntProgress(value=0, max=10), HTML(value='')))


    152625



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    
    169850



    HBox(children=(IntProgress(value=0, max=16), HTML(value='')))


    
    158191



    HBox(children=(IntProgress(value=0, max=123), HTML(value='')))


    
    142272



    HBox(children=(IntProgress(value=0, max=22), HTML(value='')))


    
    143402



    HBox(children=(IntProgress(value=0, max=11), HTML(value='')))


    
    149747



    HBox(children=(IntProgress(value=0, max=67), HTML(value='')))


    
    165514



    HBox(children=(IntProgress(value=0, max=2), HTML(value='')))


    
    159516



    HBox(children=(IntProgress(value=0, max=50), HTML(value='')))


    
    162113



    HBox(children=(IntProgress(value=0, max=13), HTML(value='')))


    
    153652



    HBox(children=(IntProgress(value=0, max=143), HTML(value='')))


    
    151674



    HBox(children=(IntProgress(value=0, max=14), HTML(value='')))


    
    132626



    HBox(children=(IntProgress(value=0, max=19), HTML(value='')))


    
    163663



    HBox(children=(IntProgress(value=0, max=31), HTML(value='')))


    
    146480



    HBox(children=(IntProgress(value=0, max=50), HTML(value='')))


    
    88227



    HBox(children=(IntProgress(value=0, max=92), HTML(value='')))


    
    172009



    HBox(children=(IntProgress(value=0, max=7), HTML(value='')))


    
    165748



    HBox(children=(IntProgress(value=0, max=25), HTML(value='')))


    
    135874



    HBox(children=(IntProgress(value=0, max=46), HTML(value='')))


    
    163842



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    18847



    HBox(children=(IntProgress(value=0, max=22), HTML(value='')))


    
    146469



    HBox(children=(IntProgress(value=0, max=354), HTML(value='')))


    
    165791



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    
    156477



    HBox(children=(IntProgress(value=0, max=11), HTML(value='')))


    
    
    146489



    HBox(children=(IntProgress(value=0, max=10), HTML(value='')))


    154437



    HBox(children=(IntProgress(value=0, max=27), HTML(value='')))


    
    140696



    HBox(children=(IntProgress(value=0, max=24), HTML(value='')))


    
    154449



    HBox(children=(IntProgress(value=0, max=39), HTML(value='')))


    
    152616



    HBox(children=(IntProgress(value=0, max=29), HTML(value='')))


    
    143390



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    143469



    HBox(children=(IntProgress(value=0, max=28), HTML(value='')))


    
    137326



    HBox(children=(IntProgress(value=0, max=40), HTML(value='')))


    
    76309



    HBox(children=(IntProgress(value=0, max=388), HTML(value='')))


    
    154573



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    162200



    HBox(children=(IntProgress(value=0, max=3), HTML(value='')))


    
    158112



    HBox(children=(IntProgress(value=0, max=50), HTML(value='')))


    
    143489



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    137970



    HBox(children=(IntProgress(value=0, max=32), HTML(value='')))


    
    152650



    HBox(children=(IntProgress(value=0, max=10), HTML(value='')))


    
    66725



    HBox(children=(IntProgress(value=0, max=42), HTML(value='')))


    
    159741



    HBox(children=(IntProgress(value=0, max=10), HTML(value='')))


    
    149517



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    143435



    HBox(children=(IntProgress(value=0, max=70), HTML(value='')))


    
    106360



    HBox(children=(IntProgress(value=0, max=53), HTML(value='')))


    
    120160



    HBox(children=(IntProgress(value=0, max=36), HTML(value='')))


    
    154112



    HBox(children=(IntProgress(value=0, max=102), HTML(value='')))


    
    152168



    HBox(children=(IntProgress(value=0, max=24), HTML(value='')))


    
    149776



    HBox(children=(IntProgress(value=0, max=20), HTML(value='')))


    
    155256



    HBox(children=(IntProgress(value=0, max=28), HTML(value='')))


    
    82473



    HBox(children=(IntProgress(value=0), HTML(value='')))


    
    164342



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    
    152170
    31827



    HBox(children=(IntProgress(value=0, max=58), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=3), HTML(value='')))


    
    162173



    HBox(children=(IntProgress(value=0, max=220), HTML(value='')))


    
    144215



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    
    137696



    HBox(children=(IntProgress(value=0, max=43), HTML(value='')))


    
    156083



    HBox(children=(IntProgress(value=0, max=103), HTML(value='')))


    
    155680



    HBox(children=(IntProgress(value=0, max=40), HTML(value='')))


    
    152396



    HBox(children=(IntProgress(value=0, max=28), HTML(value='')))


    
    159054



    HBox(children=(IntProgress(value=0, max=68), HTML(value='')))


    
    143394



    HBox(children=(IntProgress(value=0, max=51), HTML(value='')))


    
    144988



    HBox(children=(IntProgress(value=0, max=9), HTML(value='')))


    
    140803



    HBox(children=(IntProgress(value=0, max=20), HTML(value='')))


    
    165461



    HBox(children=(IntProgress(value=0, max=69), HTML(value='')))


    
    158651



    HBox(children=(IntProgress(value=0, max=11), HTML(value='')))


    
    156417



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    162956



    HBox(children=(IntProgress(value=0, max=13), HTML(value='')))


    
    152341



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    
    163027



    HBox(children=(IntProgress(value=0, max=2), HTML(value='')))


    
    129094



    HBox(children=(IntProgress(value=0, max=12), HTML(value='')))


    
    158864



    HBox(children=(IntProgress(value=0, max=22), HTML(value='')))


    
    
    154458
    158266



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=1), HTML(value='')))


    
    162933



    HBox(children=(IntProgress(value=0, max=20), HTML(value='')))


    
    160464



    HBox(children=(IntProgress(value=0, max=31), HTML(value='')))


    
    165025



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    154980



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    154668



    HBox(children=(IntProgress(value=0, max=21), HTML(value='')))


    
    156091



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    
    141675



    HBox(children=(IntProgress(value=0, max=23), HTML(value='')))


    
    148994



    HBox(children=(IntProgress(value=0, max=1), HTML(value='')))


    
    
    156185



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    62586



    HBox(children=(IntProgress(value=0, max=19), HTML(value='')))


    
    154267



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    154508



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    167035
    



    HBox(children=(IntProgress(value=0, max=27), HTML(value='')))


    146407



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    
    152309



    HBox(children=(IntProgress(value=0, max=26), HTML(value='')))


    
    165029



    HBox(children=(IntProgress(value=0, max=20), HTML(value='')))


    
    151117



    HBox(children=(IntProgress(value=0, max=14), HTML(value='')))


    
    162824



    HBox(children=(IntProgress(value=0, max=12), HTML(value='')))


    
    147067



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    158910
    



    HBox(children=(IntProgress(value=0, max=21), HTML(value='')))


    166083



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    159521



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    
    167103



    HBox(children=(IntProgress(value=0, max=1), HTML(value='')))


    155716
    
    



    HBox(children=(IntProgress(value=0, max=86), HTML(value='')))


    143099
    144213



    HBox(children=(IntProgress(value=0, max=12), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=28), HTML(value='')))


    
    
    142634



    HBox(children=(IntProgress(value=0, max=23), HTML(value='')))


    141184



    HBox(children=(IntProgress(value=0, max=7), HTML(value='')))


    
    38227



    HBox(children=(IntProgress(value=0, max=2), HTML(value='')))


    
    144280



    HBox(children=(IntProgress(value=0, max=58), HTML(value='')))


    
    137945



    HBox(children=(IntProgress(value=0, max=11), HTML(value='')))


    
    154262



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    
    125401
    114268



    HBox(children=(IntProgress(value=0, max=25), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    125473



    HBox(children=(IntProgress(value=0, max=30), HTML(value='')))


    
    149757



    HBox(children=(IntProgress(value=0, max=23), HTML(value='')))


    
    
    149221



    HBox(children=(IntProgress(value=0, max=52), HTML(value='')))


    146485



    HBox(children=(IntProgress(value=0, max=52), HTML(value='')))


    
    123630



    HBox(children=(IntProgress(value=0, max=123), HTML(value='')))


    
    146506



    HBox(children=(IntProgress(value=0, max=337), HTML(value='')))


    
    134838
    



    HBox(children=(IntProgress(value=0, max=90), HTML(value='')))


    140731



    HBox(children=(IntProgress(value=0, max=33), HTML(value='')))


    
    143499



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    97857



    HBox(children=(IntProgress(value=0, max=29), HTML(value='')))


    
    118966



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    161847



    HBox(children=(IntProgress(value=0, max=22), HTML(value='')))


    
    137875



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    
    136872



    HBox(children=(IntProgress(value=0, max=20), HTML(value='')))


    
    117787



    HBox(children=(IntProgress(value=0, max=55), HTML(value='')))


    
    143473



    HBox(children=(IntProgress(value=0, max=111), HTML(value='')))


    
    142699



    HBox(children=(IntProgress(value=0, max=22), HTML(value='')))


    
    147092



    HBox(children=(IntProgress(value=0, max=38), HTML(value='')))


    
    144927



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    
    149512



    HBox(children=(IntProgress(value=0, max=28), HTML(value='')))


    
    152331



    HBox(children=(IntProgress(value=0, max=37), HTML(value='')))


    
    101904



    HBox(children=(IntProgress(value=0, max=17), HTML(value='')))


    
    142324



    HBox(children=(IntProgress(value=0, max=14), HTML(value='')))


    
    134772



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    160135



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    127382



    HBox(children=(IntProgress(value=0, max=71), HTML(value='')))


    
    142632



    HBox(children=(IntProgress(value=0, max=27), HTML(value='')))


    
    144984



    HBox(children=(IntProgress(value=0, max=21), HTML(value='')))


    
    160720
    



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    125447



    HBox(children=(IntProgress(value=0, max=3), HTML(value='')))


    
    127398



    HBox(children=(IntProgress(value=0, max=55), HTML(value='')))


    
    156465



    HBox(children=(IntProgress(value=0, max=134), HTML(value='')))


    
    152684



    HBox(children=(IntProgress(value=0, max=37), HTML(value='')))


    
    146524



    HBox(children=(IntProgress(value=0, max=20), HTML(value='')))


    
    90922



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    70627



    HBox(children=(IntProgress(value=0, max=16), HTML(value='')))


    
    94183



    HBox(children=(IntProgress(value=0, max=28), HTML(value='')))


    
    143932



    HBox(children=(IntProgress(value=0, max=26), HTML(value='')))


    
    142730



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    142384



    HBox(children=(IntProgress(value=0, max=62), HTML(value='')))


    
    153964



    HBox(children=(IntProgress(value=0, max=36), HTML(value='')))


    
    127397



    HBox(children=(IntProgress(value=0, max=71), HTML(value='')))


    
    160750



    HBox(children=(IntProgress(value=0, max=16), HTML(value='')))


    
    127346



    HBox(children=(IntProgress(value=0, max=14), HTML(value='')))


    
    152633



    HBox(children=(IntProgress(value=0, max=33), HTML(value='')))


    
    150372



    HBox(children=(IntProgress(value=0, max=2), HTML(value='')))


    
    99715



    HBox(children=(IntProgress(value=0, max=67), HTML(value='')))


    
    144314



    HBox(children=(IntProgress(value=0, max=109), HTML(value='')))


    
    125417



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    
    157500
    142255



    HBox(children=(IntProgress(value=0, max=11), HTML(value='')))



    HBox(children=(IntProgress(value=0, max=29), HTML(value='')))


    
    146459



    HBox(children=(IntProgress(value=0, max=35), HTML(value='')))


    
    159408



    HBox(children=(IntProgress(value=0, max=18), HTML(value='')))


    
    127374



    HBox(children=(IntProgress(value=0, max=35), HTML(value='')))


    
    130713



    HBox(children=(IntProgress(value=0, max=51), HTML(value='')))


    
    152161



    HBox(children=(IntProgress(value=0, max=76), HTML(value='')))


    
    156259



    HBox(children=(IntProgress(value=0, max=8), HTML(value='')))


    
    
    110333



    HBox(children=(IntProgress(value=0, max=56), HTML(value='')))


    158536



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    146517



    HBox(children=(IntProgress(value=0, max=149), HTML(value='')))


    
    142305



    HBox(children=(IntProgress(value=0, max=56), HTML(value='')))


    
    143437



    HBox(children=(IntProgress(value=0, max=12), HTML(value='')))


    
    130849



    HBox(children=(IntProgress(value=0, max=38), HTML(value='')))


    
    143379



    HBox(children=(IntProgress(value=0, max=16), HTML(value='')))


    
    
    145162



    HBox(children=(IntProgress(value=0, max=135), HTML(value='')))


    110379



    HBox(children=(IntProgress(value=0, max=23), HTML(value='')))


    
    134841



    HBox(children=(IntProgress(value=0, max=31), HTML(value='')))


    
    149777



    HBox(children=(IntProgress(value=0, max=60), HTML(value='')))


    
    137346



    HBox(children=(IntProgress(value=0, max=60), HTML(value='')))


    
    
    31794



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    31795



    HBox(children=(IntProgress(value=0, max=4), HTML(value='')))


    
    137958



    HBox(children=(IntProgress(value=0, max=10), HTML(value='')))


    
    31796



    HBox(children=(IntProgress(value=0, max=7), HTML(value='')))


    
    149050



    HBox(children=(IntProgress(value=0, max=70), HTML(value='')))


    
    158266



    HBox(children=(IntProgress(value=0, max=1), HTML(value='')))


    
    
    136868



    HBox(children=(IntProgress(value=0, max=33), HTML(value='')))


    
    144938



    HBox(children=(IntProgress(value=0, max=26), HTML(value='')))


    
    155484



    HBox(children=(IntProgress(value=0, max=30), HTML(value='')))


    
    132933



    HBox(children=(IntProgress(value=0, max=74), HTML(value='')))


    
    136869



    HBox(children=(IntProgress(value=0, max=147), HTML(value='')))


    
    153951



    HBox(children=(IntProgress(value=0, max=34), HTML(value='')))


    
    152265



    HBox(children=(IntProgress(value=0, max=14), HTML(value='')))


    
    145292



    HBox(children=(IntProgress(value=0, max=181), HTML(value='')))


    
    136859



    HBox(children=(IntProgress(value=0, max=3), HTML(value='')))


    
    132627



    HBox(children=(IntProgress(value=0, max=25), HTML(value='')))


    
    142304



    HBox(children=(IntProgress(value=0, max=27), HTML(value='')))


    
    130984



    HBox(children=(IntProgress(value=0, max=5), HTML(value='')))


    
    102278



    HBox(children=(IntProgress(value=0, max=33), HTML(value='')))


    
    158849



    HBox(children=(IntProgress(value=0, max=41), HTML(value='')))


    
    141675



    HBox(children=(IntProgress(value=0, max=23), HTML(value='')))


    
    144081



    HBox(children=(IntProgress(value=0, max=15), HTML(value='')))


    
    126034



    HBox(children=(IntProgress(value=0, max=63), HTML(value='')))


    
    10250



    HBox(children=(IntProgress(value=0, max=1), HTML(value='')))


    
    150376



    HBox(children=(IntProgress(value=0, max=7), HTML(value='')))


    
    146526



    HBox(children=(IntProgress(value=0, max=6), HTML(value='')))


    
    116233



    HBox(children=(IntProgress(value=0, max=19), HTML(value='')))


    
    140010



    HBox(children=(IntProgress(value=0, max=47), HTML(value='')))


    
    143372



    HBox(children=(IntProgress(value=0, max=13), HTML(value='')))


    
    151192



    HBox(children=(IntProgress(value=0, max=35), HTML(value='')))


    
    156675



    HBox(children=(IntProgress(value=0, max=7), HTML(value='')))


    
    139673



    HBox(children=(IntProgress(value=0, max=39), HTML(value='')))


    
    
    118307



    HBox(children=(IntProgress(value=0, max=92), HTML(value='')))


    



    ---------------------------------------------------------------------------

    RemoteTraceback                           Traceback (most recent call last)

    RemoteTraceback: 
    """
    Traceback (most recent call last):
      File "/usr/lib/python3.6/multiprocessing/pool.py", line 119, in worker
        result = (True, func(*args, **kwds))
      File "/usr/lib/python3.6/multiprocessing/pool.py", line 44, in mapstar
        return list(map(*args))
      File "<ipython-input-2-db66e0ce5e76>", line 35, in func11
        lis = score_result.findAll('li')
    AttributeError: 'NoneType' object has no attribute 'findAll'
    """

    
    The above exception was the direct cause of the following exception:


    AttributeError                            Traceback (most recent call last)

    <ipython-input-2-db66e0ce5e76> in <module>
         49 
         50 pool = multiprocessing.Pool(processes=4)
    ---> 51 pool.map(func11,movie_lis)
         52 pool.close()
         53 pool.join()


    /usr/lib/python3.6/multiprocessing/pool.py in map(self, func, iterable, chunksize)
        286         in a list that is returned.
        287         '''
    --> 288         return self._map_async(func, iterable, mapstar, chunksize).get()
        289 
        290     def starmap(self, func, iterable, chunksize=None):


    /usr/lib/python3.6/multiprocessing/pool.py in get(self, timeout)
        668             return self._value
        669         else:
    --> 670             raise self._value
        671 
        672     def _set(self, i, obj):


    AttributeError: 'NoneType' object has no attribute 'findAll'


```python
import requests
from bs4 import BeautifulSoup
from datetime import datetime
import sys
import pandas as pd
from tqdm import tqdm_notebook
import multiprocessing

af='after'
be='before'
lis = pd.read_csv('/home/ubuntu/movie/data/naver_movie_all.csv')
movie_lis =[]

# for i in range(len(lis['naver_movieCd'])):
#     movie_lis.insert(i,str(lis['naver_movieCd'][i])[:-2])
# len(movie_lis)

def func12(code):
    lists = []
#     code=str(movie_lis[i])[:-2]
    test_url = 'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code='+code+'&type='+af+'&onlyActualPointYn=N&order=newest'
    resp = requests.get(test_url)
    html = BeautifulSoup(resp.content, 'html.parser')
    result = html.find('div', {'class':'score_total'}).find('strong').findChildren('em')[1].getText()
    total_count = int(result.replace(',', ''))
    print(code)
    for i in tqdm_notebook(range(1,int(total_count / 10) + 2)):
        url = test_url + '&page=' + str(i)
    #     print('url: "' + url + '" is parsing....')
    #     get_data(url)
        resp = requests.get(url)
        html = BeautifulSoup(resp.content, 'html.parser')
        score_result = html.find('div', {'class': 'score_result'})
    #     print(score_result)
        lis = score_result.findAll('li')
    #     print(lis[0])
        for li in lis:
            try:
                a = []
                created_at = li.find('dt').findAll('em')[-1].getText()[0:10]
                created_at = created_at.replace(".","")
                score = li.find('em').getText()
                review_text = li.find('p').getText()
                a = [created_at, score, review_text]
                lists.append(a)
            except AttributeError:
                pass
    
    df = pd.DataFrame(lists)
    df.to_csv('/home/ubuntu/movie/data/'+be+'/'+code+'.csv',index=False)
        
pool = multiprocessing.Pool(processes=8)
pool.map(func11,movie_lis)
pool.close()
pool.join()
```

```python
import requests
from bs4 import BeautifulSoup
from datetime import datetime
import sys
import os
import pandas as pd
from tqdm import tqdm_notebook
import multiprocessing

af='after'
be='before'
lis = pd.read_csv('../movie_04.csv')
j=0
movie_lis2=[]
for i in range(len(lis['naver_movieCd'])):
    if(os.path.isfile('/root/movie/data2/after/'+str(lis['naver_movieCd'][i])[:-2]+'.csv') == False):
        movie_lis2.insert(j,str(lis['naver_movieCd'][i])[:-2])
        j+=1
movie_lis2

```

```python
len(movie_lis2)
```

```python
os.path.isfile(str(lis['naver_movieCd'][2])[:-2]+'.csv')
```

```python
os.path.isfile('/root/movie/data2/after/'+str(lis['naver_movieCd'][1])[:-2]+'.csv')
```

```python
str(lis['naver_movieCd'][1])[:-2]
```

```python
movie_lis2[0]
```

```python
pool = multiprocessing.Pool(processes=8)
pool.map(func12,movie_lis2)
pool.close()
pool.join()
```

```python
import requests
from bs4 import BeautifulSoup
from datetime import datetime
import sys
import pandas as pd
from tqdm import tqdm_notebook
import multiprocessing

af='after'
be='before'
lis = pd.read_csv('../movie_04.csv')
movie_lis =['155716','136872']

# for i in range(len(lis['naver_movieCd'])):
#     movie_lis.insert(i,str(lis['naver_movieCd'][i])[:-2])
# len(movie_lis)
code = '155716'
def func12(code):
    lists = []
#     code=str(movie_lis[i])[:-2]
    test_url = 'https://movie.naver.com/movie/bi/mi/pointWriteFormList.nhn?code='+code+'&type='+af+'&onlyActualPointYn=N&order=newest'
    resp = requests.get(test_url)
    html = BeautifulSoup(resp.content, 'html.parser')
    result = html.find('div', {'class':'score_total'}).find('strong').findChildren('em')[1].getText()
    total_count = int(result.replace(',', ''))
    print(code)
    for i in tqdm_notebook(range(1,int(total_count / 10) + 2)):
        url = test_url + '&page=' + str(i)
    #     print('url: "' + url + '" is parsing....')
    #     get_data(url)
        resp = requests.get(url)
        html = BeautifulSoup(resp.content, 'html.parser')
        score_result = html.find('div', {'class': 'score_result'})
    #     print(score_result)
        lis = score_result.findAll('li')
    #     print(lis[0])
        for li in lis:
            try:
                a = []
                created_at = li.find('dt').findAll('em')[-1].getText()[0:10]
                created_at = created_at.replace(".","")
                score = li.find('em').getText()
                review_text = li.find('p').getText()
                a = [created_at, score, review_text]
                lists.append(a)
            except AttributeError:
                pass
func12(code)
```

```python
lis = pd.read_csv('/home/ubuntu/movie/data/naver_movie_all.csv')
movie_lis =[]

for i in range(len(lis['naver_movieCd'])):
    movie_lis.insert(i,str(lis['naver_movieCd'][i])[:-2])
len(movie_lis)
```




    306



```python
movie_lis
```




    ['153651',
     '158180',
     '158647',
     '151728',
     '85579',
     '149248',
     '168037',
     '158191',
     '172009',
     '165748',
     '163842',
     '18847',
     '165791',
     '146489',
     '154449',
     '137326',
     '158112',
     '66725',
     '106360',
     '154112',
     '118955',
     '154598',
     '158626',
     '171767',
     '141206',
     '159862',
     '151744',
     '159848',
     '172005',
     '155665',
     '165722',
     '163844',
     '151196',
     '169349',
     '168501',
     '125488',
     '152656',
     '160491',
     '150198',
     '142272',
     '165030',
     '171753',
     '150687',
     '170427',
     '144381',
     '152249',
     '149504',
     '151254',
     '171727',
     '152385',
     '160399',
     '154272',
     '155411',
     '39440',
     '116866',
     '144379',
     '134898',
     '164932',
     '69102',
     '166008',
     '166807',
     '164335',
     '162932',
     '154594',
     '159037',
     '100205',
     '134963',
     '125418',
     '19031',
     '36843',
     '168478',
     '144975',
     '161242',
     '159830',
     '129095',
     '154353',
     '65998',
     '150637',
     '157178',
     '161850',
     '169561',
     '160749',
     '153642',
     '152268',
     '164968',
     '165669',
     '164108',
     '143250',
     '121052',
     '142317',
     '163386',
     '99093',
     '158576',
     '155715',
     '169262',
     '164986',
     '142210',
     '169348',
     '169850',
     '149747',
     '156200',
     '125439',
     '137890',
     '152625',
     '143402',
     '165514',
     '159516',
     '151674',
     '163663',
     '88227',
     '140696',
     '143390',
     '143469',
     '154573',
     '162200',
     '143489',
     '137970',
     '152650',
     '159741',
     '149517',
     '162113',
     '153652',
     '146469',
     '152170',
     '144215',
     '137696',
     '155680',
     '143394',
     '165461',
     '154668',
     '154267',
     '167035',
     '162824',
     '167103',
     '144213',
     '137945',
     '125401',
     '149757',
     '146506',
     '70627',
     '132626',
     '146480',
     '135874',
     '156477',
     '154437',
     '152616',
     '76309',
     '152396',
     '159054',
     '158651',
     '152341',
     '154458',
     '165025',
     '141675',
     '146407',
     '151117',
     '166083',
     '155716',
     '123630',
     '137008',
     '143435',
     '120160',
     '152168',
     '149776',
     '155256',
     '164342',
     '31827',
     '162173',
     '162956',
     '158864',
     '160464',
     '148994',
     '62586',
     '165029',
     '158910',
     '142634',
     '154262',
     '114268',
     '125473',
     '149221',
     '82473',
     '156083',
     '144988',
     '140803',
     '156417',
     '163027',
     '129094',
     '158266',
     '162933',
     '154980',
     '156091',
     '156185',
     '154508',
     '152309',
     '147067',
     '159521',
     '143099',
     '141184',
     '38227',
     '144280',
     '146485',
     '140731',
     '118966',
     '161847',
     '136872',
     '143473',
     '160135',
     '144984',
     '125447',
     '127398',
     '146524',
     '94183',
     '153964',
     '127346',
     '150372',
     '99715',
     '127374',
     '156259',
     '158536',
     '146517',
     '134838',
     '142699',
     '147092',
     '152331',
     '142324',
     '142632',
     '160720',
     '156465',
     '160750',
     '152633',
     '146544',
     '154214',
     '149731',
     '137909',
     '38197',
     '114247',
     '161374',
     '143490',
     '162471',
     '137976',
     '143499',
     '97857',
     '137875',
     '117787',
     '144927',
     '149512',
     '101904',
     '134772',
     '127382',
     '152684',
     '90922',
     '143932',
     '127397',
     '125417',
     '142255',
     '159408',
     '152161',
     '143437',
     '143379',
     '110379',
     '142730',
     '142384',
     '144314',
     '110333',
     '130849',
     '134841',
     '137346',
     '149050',
     '155484',
     '136869',
     '136859',
     '132627',
     '142304',
     '130984',
     '102278',
     '158849',
     '144081',
     '126034',
     '143372',
     '151192',
     '157500',
     '146459',
     '130713',
     '142305',
     '145162',
     '136868',
     '144938',
     '132933',
     '153951',
     '152265',
     '145292',
     '141675',
     '10250',
     '150376',
     '146526',
     '116233',
     '140010',
     '156675',
     '139673',
     '118307',
     '149777',
     '31794',
     '31795',
     '137958',
     '31796',
     '158266']



```python

```
