
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>9. 분석 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="111.html" />
    
    
    <link rel="prev" href="3-5-1.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    빅데이터 영화 분석
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="1.html">
            
                <a href="1.html">
            
                    
                    1. 데이터 분석 설계
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="2.html">
            
                <a href="2.html">
            
                    
                    2. 데이터 준비
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.3" data-path="3.html">
            
                <a href="3.html">
            
                    
                    3. KOBIS OPEN API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.4" data-path="3-2.html">
            
                <a href="3-2.html">
            
                    
                    4. 네이버 OPEN API
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.5" data-path="3-3.html">
            
                <a href="3-3.html">
            
                    
                    5. 데이터 전처리
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.6" data-path="3-4.html">
            
                <a href="3-4.html">
            
                    
                    6. 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.7" data-path="3-5.html">
            
                <a href="3-5.html">
            
                    
                    7. 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.8" data-path="3-5-1.html">
            
                <a href="3-5-1.html">
            
                    
                    8. 
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.1.9" data-path="3-6.html">
            
                <a href="3-6.html">
            
                    
                    9. 분석
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.10" data-path="111.html">
            
                <a href="111.html">
            
                    
                    10. 분석1
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.11" >
            
                <span>
            
                    
                    11. 분석2
            
                </span>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.12" data-path="222.html">
            
                <a href="222.html">
            
                    
                    13. 분석3
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.13" >
            
                <span>
            
                    
                    [14. 결론]
            
                </span>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="LINK.html">
            
                <a href="LINK.html">
            
                    
                    링크
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">reference</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="AWS.html">
            
                <a href="AWS.html">
            
                    
                    * AWS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="DDNS.html">
            
                <a href="DDNS.html">
            
                    
                    * DDNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="GIT.html">
            
                <a href="GIT.html">
            
                    
                    * GIT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="GITBOOK.html">
            
                <a href="GITBOOK.html">
            
                    
                    * GITBOOK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="JUPYTER-NOTEBOOK.html">
            
                <a href="JUPYTER-NOTEBOOK.html">
            
                    
                    * JUPYTER-NOTEBOOK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="NETWORK.html">
            
                <a href="NETWORK.html">
            
                    
                    * NETWORK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="REF.html">
            
                <a href="REF.html">
            
                    
                    * REF
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >9. 분석</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <pre><code class="lang-python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup
<span class="hljs-keyword">from</span> datetime <span class="hljs-keyword">import</span> datetime
<span class="hljs-keyword">import</span> sys
<span class="hljs-keyword">import</span> os
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm_notebook
<span class="hljs-keyword">import</span> multiprocessing

af=<span class="hljs-string">&apos;after&apos;</span>
be=<span class="hljs-string">&apos;before&apos;</span>
lis = pd.read_csv(<span class="hljs-string">&apos;/home/ubuntu/movie/data/naver_movie_all.csv&apos;</span>)
j=<span class="hljs-number">0</span>
movie_lis2=[]
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(lis[<span class="hljs-string">&apos;naver_movieCd&apos;</span>])):
    <span class="hljs-keyword">if</span>(os.path.isfile(<span class="hljs-string">&apos;/home/ubuntu/movie/data/after/&apos;</span>+str(lis[<span class="hljs-string">&apos;naver_movieCd&apos;</span>][i])[:<span class="hljs-number">-2</span>]+<span class="hljs-string">&apos;.csv&apos;</span>) == <span class="hljs-keyword">True</span>):
        movie_lis2.insert(j,str(lis[<span class="hljs-string">&apos;naver_movieCd&apos;</span>][i])[:<span class="hljs-number">-2</span>])
        j+=<span class="hljs-number">1</span>
<span class="hljs-comment"># movie_lis2</span>
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> multiprocessing
</code></pre>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func123</span><span class="hljs-params">(code)</span>:</span>    
    print(code)
    df = pd.read_csv(<span class="hljs-string">&apos;/home/ubuntu/movie/data/after/&apos;</span>+code+<span class="hljs-string">&apos;.csv&apos;</span>)
    df2 = df[<span class="hljs-string">&apos;0&apos;</span>].drop_duplicates()

    aa_list=[]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(df2):
        aa = np.where(df[<span class="hljs-string">&apos;0&apos;</span>] == i)
        aa_list.append(aa)

    bb_list=[]
    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> tqdm_notebook(range(len(aa_list))):
        tmp=<span class="hljs-number">0</span>
        tmp_score=<span class="hljs-number">0</span>
        len1 = len(aa_list[i][<span class="hljs-number">0</span>])            
        bb_list.append(len1)

    list2= pd.DataFrame(list(zip(df2,bb_list)))
    list2.to_csv(<span class="hljs-string">&apos;/home/ubuntu/movie/data/after_rating/&apos;</span>+code+<span class="hljs-string">&apos;_rating.csv&apos;</span>,index=<span class="hljs-keyword">False</span>)
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> code <span class="hljs-keyword">in</span> tqdm_notebook(movie_lis2):
    func123(code)
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm_notebook
df1 = pd.read_csv(<span class="hljs-string">&apos;/home/ubuntu/movie/data/naver_movie_all.csv&apos;</span>)

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">func22</span><span class="hljs-params">(i)</span>:</span>
    ncd = str(df1[<span class="hljs-string">&apos;naver_movieCd&apos;</span>][i])[:<span class="hljs-number">-2</span>]
    print(ncd)
    <span class="hljs-keyword">try</span>:
        df2 = pd.read_csv(<span class="hljs-string">&apos;/home/ubuntu/movie/data/datalab/&apos;</span>+ncd+<span class="hljs-string">&apos;_datalab.csv&apos;</span>)
        df3 = pd.read_csv(<span class="hljs-string">&apos;/home/ubuntu/movie/data/after_rating/&apos;</span>+ncd+<span class="hljs-string">&apos;_rating.csv&apos;</span>)

        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(len(df3)):
            df3[<span class="hljs-string">&apos;0&apos;</span>][i] = str(df3[<span class="hljs-string">&apos;0&apos;</span>][i])[<span class="hljs-number">0</span>:<span class="hljs-number">4</span>]+<span class="hljs-string">&quot;-&quot;</span>+str(df3[<span class="hljs-string">&apos;0&apos;</span>][i])[<span class="hljs-number">4</span>:<span class="hljs-number">6</span>]+<span class="hljs-string">&quot;-&quot;</span>+str(df3[<span class="hljs-string">&apos;0&apos;</span>][i])[<span class="hljs-number">6</span>:<span class="hljs-number">8</span>]
        df3.rename(columns={<span class="hljs-string">&quot;0&quot;</span>:<span class="hljs-string">&quot;period&quot;</span>}, inplace = <span class="hljs-keyword">True</span>)
        df4 = pd.merge(df2,df3,how=<span class="hljs-string">&apos;left&apos;</span>,on=<span class="hljs-string">&apos;period&apos;</span>)
        df4.to_csv(<span class="hljs-string">&apos;/home/ubuntu/movie/data/merge/&apos;</span>+ncd+<span class="hljs-string">&apos;_merge.csv&apos;</span>,index=<span class="hljs-keyword">False</span>)
    <span class="hljs-keyword">except</span> FileNotFoundError:
        <span class="hljs-keyword">pass</span>
</code></pre>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> multiprocessing
<span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm_notebook
pool = multiprocessing.Pool(processes=<span class="hljs-number">4</span>)
pool.map(func22,range(<span class="hljs-number">0</span>,len(df1)))
pool.close()
pool.join()
</code></pre>
<pre><code>165030
118955
153651
166807


/home/ubuntu/.local/lib/python3.6/site-packages/ipykernel_launcher.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  del sys.path[0]
/home/ubuntu/.local/lib/python3.6/site-packages/ipykernel_launcher.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  del sys.path[0]
/home/ubuntu/.local/lib/python3.6/site-packages/ipykernel_launcher.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  del sys.path[0]
/home/ubuntu/.local/lib/python3.6/site-packages/ipykernel_launcher.py:13: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-view-versus-copy
  del sys.path[0]


164335
171753
162932
150687
154598
154594
158180
170427
159037
158626
144381
152249
100205
158647
171767
141206
149504
134963
151728
151254
159862
171727
152385
151744
85579
159848
160399
125418
172005
19031
36843
168478
149248
144975
154272
155665
161242
168037
155411
158191
165722
159830
163844
39440
116866
151196
172009
165748
144379
129095
169349
163842
168501
125488
154353
18847
165791
134898
146489
65998
150637
152656
154449
164932
160491
157178
150198
137326
69102
166008
169561
160749
158112
161850
153642
66725
106360
142272
152268
156200
162113
125439
153652
164968
137890
154112
165669
152625
146469
164108
143250
121052
132626
143402
142317
146480
152170
163386
165514
159516
99093
158576
135874
155715
144215
169262
151674
137696
164986
156477
142210
163663
88227
169348
154437
169850
155680
149747
140696
143394
152616
143390
143435
143469
165461
76309
120160
154573
154668
152396
162200
143489
152168
137970
154267
159054
167035
162824
158651
149776
152650
152341
167103
144213
155256
137945
159741
154458
125401
165025
149517
141675
82473
146407
149757
164342
31827
162173
151117
156083
146506
166083
162956
155716
158864
160464
70627
148994
144988
62586
165029
146485
123630
158910
142634
140803
154262
140731
156417
137008
114268
125473
163027
129094
118966
161847
136872
134838
149221
158266
162933
154980
142699
143499
143473
156091
97857
137875
156185
154508
147092
160135
144984
152309
117787
125447
147067
152331
159521
143099
127398
141184
38227
144280
144927
142324
142632
146524
142730
149512
160720
142384
94183
156465
153964
101904
160750
134772
152633
144314
127382
127346
150372
146544
99715
110333
154214
152684
127374
149731
130849
90922
137909
38197
114247
156259
143932
161374
158536
143490
146517
134841
162471
137976
127397
157500
137346
149777
146459
149050
125417
155484
136869
142255
31794
159408
130713
152161
142305
136859
143437
132627
143379
142304
110379
130984
145162
102278
158849
144081
136868
126034
144938
143372
151192
132933
31795
153951
152265
145292
141675
10250
150376
146526
116233
137958
140010
31796
156675
139673
118307
158266
</code></pre><pre><code class="lang-python">

</code></pre>
<pre><code class="lang-python">

</code></pre>
<pre><code class="lang-python">

</code></pre>
<pre><code class="lang-python">

</code></pre>
<pre><code class="lang-python">

</code></pre>
<pre><code class="lang-python">

</code></pre>
<pre><code class="lang-python">

</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="3-5-1.html" class="navigation navigation-prev " aria-label="Previous page: 8. ">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="111.html" class="navigation navigation-next " aria-label="Next page: 10. 분석1">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"9. 분석","level":"1.1.9","depth":2,"next":{"title":"10. 분석1","level":"1.1.10","depth":2,"path":"111.md","ref":"111.md","articles":[]},"previous":{"title":"8. ","level":"1.1.8","depth":2,"path":"3-5-1.md","ref":"3-5-1.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"3-6.md","mtime":"2019-02-13T07:29:43.588Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2019-02-14T05:35:14.541Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

